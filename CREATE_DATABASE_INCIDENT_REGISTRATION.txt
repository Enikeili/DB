DELETE FROM PERSON;
DELETE FROM RESOLUTION;
DELETE FROM INCIDENT;

DROP TABLE PERSON;
DROP TABLE RESOLUTION;
DROP TABLE INCIDENT;

SET DATEFORMAT dmy;

CREATE TABLE INCIDENT (
  INCIDENT_ID         INTEGER PRIMARY KEY,
  REGISTRATION_DATE   DATE,
  INCIDENT_TYPE       CHAR(100) NOT NULL
);

CREATE TABLE PERSON (
   PERSON_ID            INTEGER PRIMARY KEY,
   SURNAME              CHAR(30) NOT NULL,
   NAME                 CHAR(30) NOT NULL,
   PATRONYMIC           CHAR(30) NOT NULL,
   ADDRESS              CHAR(30),
   CONVICTIONS_NUMBER   INTEGER,
   ROLE_PERSON          CHAR(30), 
   INCIDENT_ID          INTEGER REFERENCES INCIDENT(INCIDENT_ID)
);

CREATE TABLE RESOLUTION (
  RESOLUTION_ID      INTEGER PRIMARY KEY,
  RESOLUTION_TYPE    CHAR(60) NOT NULL,
  LEVEL_INSTANTION   INTEGER DEFAULT 0,
  INCIDENT_ID        INTEGER REFERENCES INCIDENT(INCIDENT_ID),
  CHECK (LEVEL_INSTANTION>=0 AND LEVEL_INSTANTION<=3)
);